<?xml version="1.0"?>
<configuration>
  <appSettings>
    <add key="aspnet:MaxHttpCollectionKeys" value="50000"/>
    <add key="ConnectionString" value="Provider=Microsoft.Jet.OleDb.4.0;Data Source=|DataDirectory|Zero2.mdb"/>
    <!--编辑器路径-->
    <add key="FCKeditor:BasePath" value="~/liuuyuuy/"/>
    <!--编辑器上传路径-->
    <add key="FCKeditor:UserFilesPath" value="/UploadFiles/"/>
    <!--站点名称-->
    <add key="Web" value="有限公司"/>
  </appSettings>
  <connectionStrings>
    <!--数据库连接字符-->
    <add name="ConnStr" connectionString="~/App_Data/Zero2.mdb"/>
  </connectionStrings>
  <!--
    有关 web.config 更改的说明，请参见 http://go.microsoft.com/fwlink/?LinkId=235367。

    可在 <httpRuntime> 标记上设置以下特性。
      <system.Web>
        <httpRuntime targetFramework="4.8" />
      </system.Web>
  -->
  <system.web>
    <globalization requestEncoding="utf-8" responseEncoding="utf-8" culture="zh-CN"/>
    <!--会话超时 分钟-->
    <sessionState timeout="30" mode="InProc"/>
    <!-- 
            设置 compilation debug="true" 将调试符号插入
            已编译的页面中。但由于这会 
            影响性能，因此只在开发过程中将此值 
            设置为 true。
        -->
    <compilation debug="true" targetFramework="4.8">
      <assemblies>
        <add assembly="System.Design, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B03F5F7F11D50A3A"/>
        <add assembly="System.Windows.Forms, Version=4.0.0.0, Culture=neutral, PublicKeyToken=B77A5C561934E089"/>
      </assemblies>
    </compilation>
    <!--
            通过 <authentication> 节可以配置 ASP.NET 使用的 
            安全身份验证模式，
            以标识传入的用户。 
        -->
    <authentication mode="Windows"/>
    <httpHandlers>
      <!-- 
        The httpHandler that files are uploaded to, defined in App_Code/Upload.cs
      -->
      <remove verb="POST,GET" path="Upload.axd"/>
      <add verb="POST,GET" path="Upload.axd" type="Upload"/>
      <remove verb="POST,GET" path="Upload2.axd"/>
      <add verb="POST,GET" path="Upload2.axd" type="Upload2"/>
    </httpHandlers>
    <!-- 
        The maximum files size allowed
      -->
    <httpRuntime maxRequestLength="1550000" requestValidationMode="2.0"/>
    <!--发生错误则跳转到Error.htm-->
    <customErrors mode="Off">
      <error statusCode="401" redirect="Connector-404.html"/>
      <error statusCode="403" redirect="Connector-404.html"/>
      <error statusCode="404" redirect="Connector-404.html"/>
      <error statusCode="405" redirect="Connector-404.html"/>
      <error statusCode="406" redirect="Connector-404.html"/>
      <error statusCode="412" redirect="Connector-404.html"/>
      <error statusCode="500" redirect="Connector-404.html"/>
      <error statusCode="501" redirect="Connector-404.html"/>
      <error statusCode="502" redirect="Connector-404.html"/>
    </customErrors>
    <pages controlRenderingCompatibilityVersion="3.5" clientIDMode="AutoID"/>
  </system.web>
  <system.webServer>
    <security>
      <requestFiltering allowDoubleEscaping="true"/>
    </security>
    <validation validateIntegratedModeConfiguration="false"/>
    <defaultDocument>
      <files>
        <remove value="Connector-Index.aspx"/>
        <remove value="default.aspx"/>
        <remove value="Default.asp"/>
        <remove value="index.html"/>
        <remove value="iisstart.htm"/>
        <remove value="index.htm"/>
        <remove value="Default.htm"/>
        <add value="Connector-Index.aspx"/>
      </files>
    </defaultDocument>
    <staticContent>
      <remove fileExtension=".svg"/>
      <mimeMap fileExtension=".properties" mimeType="application/octet-stream"/>
      <!--    <mimeMap fileExtension=".woff" mimeType="application/x-font-woff" />  -->
      <mimeMap fileExtension=".svg" mimeType="image/svg+xml"/>
    </staticContent>
    <httpErrors errorMode="Custom">
      <remove statusCode="403" subStatusCode="-1"/>
      <remove statusCode="404"/>
      <error statusCode="404" path="Connector-404.html" responseMode="File"/>
            <error statusCode="403" prefixLanguageFilePath="" path="https://www.wis-connector.com" responseMode="Redirect" />
    </httpErrors>



 <rewrite>



    <rules>


<rule name="WWW Redirect" stopProcessing="true">
<match url=".*" />
<conditions>
<add input="{HTTP_HOST}" pattern="^wis-connector.com$" />
</conditions>
<action type="Redirect" url="http://www.wis-connector.com/{R:0}" redirectType="Permanent" />
</rule>

      <rule name="HTTP to HTTPS redirect" stopProcessing="true">
        <match url="(.*)" />
        <conditions>
          <add input="{HTTPS}" pattern="off" ignoreCase="true" />
        </conditions>
        <action type="Redirect" redirectType="Found" url="https://{HTTP_HOST}/{R:1}" />
      </rule>
    </rules>
  </rewrite>
  </system.webServer>
  
</configuration>